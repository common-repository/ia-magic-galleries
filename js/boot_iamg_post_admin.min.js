/*! ia-designer 09-10-2024 
Copyright Â© 2024 Information Aesthetics. All rights reserved.
This work is licensed under the GPL2, V2/ license.*/

window.addEventListener("load",function(){let e;const t=wp.i18n.__;let i=window.location.href,l=i.includes("post-new.php"),s=document.getElementById("save-post"),n=document.getElementsByName("publish")[0];l&&(n&&(n.disabled=!0),s&&(s.disabled=!0));const o=()=>{function o(e){if(e.thumbnail&&e.thumbnail.url)return e.thumbnail.url;let t=e.sizes,i="",l=0;for(let e,s=0;s<t.length;s++)e=t[s],(0===l||e[1][0]<l)&&(l=e[1][0],i=e[0]);return i||(e.download?e.download:"")}eve_ia.on(["ia","gui","created"],function(t){let i=document.getElementsByClassName("iamg-loading-gif")[0];i&&i.remove(),this.eve.once(["presenter","loaded"],function(t){let i=iamg_settings.gallery_properties;if(e=iamg_settings.id,!i.type)return;const l=i.type;let s=i.images||[];const n=i.requested_images||[],r=i.resource;let a,d;for(let e in i)i.hasOwnProperty(e)&&e.startsWith(l)&&((a=a||{})[e]=i[e]);d=function(e,t){const i=[];let l=t.length;for(let s,n=0;n<e.length;n++){s=e[n].title;for(let r=0;r<l;r++){let a=t[(n+r)%l];if(s===a.title){i.push({id:s+"_"+a.id,url:o(e[n]),title:s,data:a.data});break}}}return i}(s,n),t.eve(["iamg","load_gallery_setup"],void 0,l,d,a,r)}.bind(void 0,this))(100)}),eve_ia.on(["global","iamg","gallery","save"],function(e){const o=this;let r=document.getElementsByName("post_title")[0].value;if(!r)return void o.eve("gui.alert",t("Please, enter gallery title")+".",[200,100],[t("OK")]);const a={command:"save",locator:e,title:r,post_id:iamg_settings.post_id,is_gallery_post:!0};o.comManager.wpCommand(a,function(e){let r={margin:{top:10,bottom:5,left:10,right:5}};if(e.error)return o.eve("gui.alert",t("Gallery was not saved successfully")+".",[220,70],[t("OK")],[],r),o.eve("gui.error",e.error),n&&(n.disabled=!1),void(s&&(s.disabled=!1));o.eve("gui.alert",t("Gallery is saved successfully")+".",[200,70],[t("OK")],[function(){l&&(i=i.replace(/post-new\.php.*/,"post.php?post="+iamg_settings.post_id+"&action=edit"),s&&(s.disabled=!1),s.click())}],r),n&&(n.disabled=!1)},function(e){o.eve("gui.error",t("Server Error Occurred"))})})};window.IA_Presenter_loader&&IA_Presenter_loader(iamg_settings.settings,void 0,iamg_settings.resources,{after_callback:o,post_scripts:["media_upload.min.js"]})});